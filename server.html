<html><body>
  <div id="log"></div>
  <script src="https://kandy-portal.s3.amazonaws.com/public/javascript/kandy/2.3.0/kandy.js" >
  </script>

  <script>
  var projectAPIKey = "DAKc67cc9a3927142dd88af8a93cc79e0a2";
  var username = "gitmasteruser";
  var password = "fakepword123";

kandy.login(projectAPIKey, username, password, onLoginSuccess, onLoginFailure);

kandy.setup({
  // Register listeners to group chat events.
  listeners: {
    chatGroupMessage: onChatGroupMessage /*,
    chatGroupInvite: onChatGroupInvite,
    chatGroupBoot: onChatGroupBoot,
    chatGroupUpdate: onChatGroupUpdate,
    chatGroupDelete: onChatGroupDelete*/
  }
});

// What to do on a successful login.
function onLoginSuccess() {
    log("Login was successful.");
}

// What to do on a failed login.
function onLoginFailure() {
    log("Login failed. Make sure you input the user's credentials!");
}

// Utility function for appending messages to the message div.
function log(message) {
    document.getElementById("log").innerHTML += "<div>" + message + "</div>";
}

function onChatGroupMessage(message) {
  // Handle the message.
  var id = message.group_id;
  var messageText = message.message.text;
  var sender = message.sender.user_id;
  // Create the message element. Use Lodash to escape the message to prevent security issues.

  // Add the message to the chat messages div.

  var fullMessage = {
    id: id,
    messageText: messageText,
    sender: sender
  }

  log(id + "|" + sender + "|" + messageText);
}

log("Testing");
</script>
</body></html>
